// Generated by CoffeeScript 1.4.0
(function(){"use strict";var e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v=function(e,t){return function(){return e.apply(t,arguments)}};c=window,o=[],e=c.$||!1,i=!1,f=!0,h=document.createElement("div"),l=["Webkit","Moz","O","ms","Khtml"],n={transform:"transform",origin:"transformOrigin",transformStyle:"transformStyle",transitionProp:"transitionProperty",transitionDuration:"transitionDuration",transitionEasing:"transitionTimingFunction",perspective:"perspective",backface:"backfaceVisibility"},p=function(e){var t,n,r,i;if(h.style[e]!=null)return e;t=e.charAt(0).toUpperCase()+e.slice(1);for(r=0,i=l.length;r<i;r++){n=l[r];if(h.style[n+t]!=null)return n+t}return!1};for(u in n){d=n[u],n[u]=p(d);if(!n[u]){i&&console.warn("oriDomi: Browser does not support oriDomi"),f=!1;break}}n.gradientProp=function(){var e,t,n,r;for(n=0,r=l.length;n<r;n++){t=l[n],e="-"+t.toLowerCase()+"-linear-gradient",h.style.backgroundImage=""+e+"(left, #000, #fff)";if(h.style.backgroundImage.indexOf("gradient")!==-1)return e}return"linear-gradient"}(),n.transformProp=function(){var e;return e=n.transform.match(/(\w+)Transform/i),e?"-"+e[1].toLowerCase()+"-transform":"transform"}(),n.transitionEnd=function(){switch(n.transitionProp){case"transitionProperty":return"transitionEnd";case"WebkitTransitionProperty":return"webkitTransitionEnd";case"MozTransitionProperty":return"transitionend";case"OTransitionProperty":return"oTransitionEnd";case"MSTransitionProperty":return"msTransitionEnd"}}(),s=function(e,t){var n;if(t!==Object(t))return i&&console.warn("oriDomi: Must pass an object to extend with"),e;e!==Object(e)&&(e={});for(n in t)e[n]==null&&(e[n]=t[n]);return e},a=function(){},r={vPanels:3,hPanels:3,perspective:1e3,shading:"hard",speed:700,oriDomiClass:"oridomi",shadingIntensity:1,easingMethod:"",showOnStart:!1,forceAntialiasing:!1,touchEnabled:!0,touchSensitivity:.25,touchStartCallback:a,touchMoveCallback:a,touchEndCallback:a},t=function(){function t(a,l){var h,p,d,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,_,D,P,H,B,j,F,I,q,R,U,z,W,X,V,J,K,Q,G,Y,Z,et,tt,nt;this.el=a,this._onTouchEnd=v(this._onTouchEnd,this),this._onTouchMove=v(this._onTouchMove,this),this._onTouchStart=v(this._onTouchStart,this),i&&console.time("oridomiConstruction");if(!f)return this.el;if(!(this instanceof t))return new oriDomi(this.el,this.settings);this.settings=s(l,r);if(!this.el||this.el.nodeType!==1){i&&console.warn("oriDomi: First argument must be a DOM element");return}this.cleanEl=this.el.cloneNode(!0),this.cleanEl.style.margin="0",this.cleanEl.style.position="absolute",this.cleanEl.style[n.transform]="translate3d(-9999px, 0, 0)",V=this.settings,this.shading=V.shading,this.shadingIntensity=V.shadingIntensity,this.vPanels=V.vPanels,this.hPanels=V.hPanels,y=c.getComputedStyle(this.el),this.displayStyle=y.display,this.displayStyle==="none"&&(this.displayStyle="block"),this.width=parseInt(y.width,10)+parseInt(y.paddingLeft,10)+parseInt(y.paddingRight,10)+parseInt(y.borderLeftWidth,10)+parseInt(y.borderRightWidth,10),this.height=parseInt(y.height,10)+parseInt(y.paddingTop,10)+parseInt(y.paddingBottom,10)+parseInt(y.borderTopWidth,10)+parseInt(y.borderBottomWidth,10),this.panelWidth=this.width/this.vPanels,this.panelHeight=this.height/this.hPanels,this.lastAngle=0,this.isFoldedUp=!1,this.isFrozen=!1,this.anchors=["left","right","top","bottom"],this.lastAnchor=this.anchors[0],this.panels={},this.stages={},C=document.createElement("div"),C.style.width=this.width+"px",C.style.height=this.height+"px",C.style.display="none",C.style.position="absolute",C.style.padding="0",C.style.margin="0",C.style[n.perspective]=this.settings.perspective+"px",J=this.anchors;for(_=0,B=J.length;_<B;_++)h=J[_],this.panels[h]=[],this.stages[h]=C.cloneNode(!1),this.stages[h].className="oridomi-stage-"+h;if(this.shading){this.shaders={},K=this.anchors;for(D=0,j=K.length;D<j;D++)h=K[D],this.shaders[h]={},h==="left"||h==="right"?(this.shaders[h].left=[],this.shaders[h].right=[]):(this.shaders[h].top=[],this.shaders[h].bottom=[]);N=document.createElement("div"),N.style[n.transitionProp]="opacity",N.style[n.transitionDuration]=this.settings.speed+"ms",N.style[n.transitionEasing]=this.settings.easingMethod,N.style.position="absolute",N.style.width="100%",N.style.height="100%",N.style.opacity="0",N.style.top="0",N.style.left="0"}g=this.el.cloneNode(!0),g.classList.add("oridomi-content"),g.style.margin="0",g.style.position="relative",g.style.float="none",b=document.createElement("div"),b.className="oridomi-mask-h",b.style.position="absolute",b.style.overflow="hidden",b.style.width="100%",b.style.height="100%",b.style[n.transform]="translate3d(0, 0, 0)",b.appendChild(g),this.shading&&(k=N.cloneNode(!1),k.className="oridomi-shader-top",k.style.background=this._getShaderGradient("top"),d=N.cloneNode(!1),d.className="oridomi-shader-bottom",d.style.background=this._getShaderGradient("bottom"),b.appendChild(k),b.appendChild(d)),p=2,w=document.createElement("div"),w.className="oridomi-panel-h",w.style.width="100%",w.style.height=this.panelHeight+p+"px",w.style.padding="0",w.style.position="relative",w.style[n.transitionProp]=n.transformProp,w.style[n.transitionDuration]=this.settings.speed+"ms",w.style[n.transitionEasing]=this.settings.easingMethod,w.style[n.origin]="top",w.style[n.transformStyle]="preserve-3d",w.style[n.backface]="hidden",this.settings.forceAntialiasing&&(w.style.outline="1px solid transparent"),w.appendChild(b),Q=["top","bottom"];for(P=0,F=Q.length;P<F;P++){h=Q[P];for(E=H=0,G=this.hPanels;0<=G?H<G:H>G;E=0<=G?++H:--H)x=w.cloneNode(!0),m=x.getElementsByClassName("oridomi-content")[0],h==="top"?(M=-(E*this.panelHeight),E===0?x.style.top="0":x.style.top=this.panelHeight+"px"):(x.style[n.origin]="bottom",M=-(this.hPanels*this.panelHeight-this.panelHeight*(E+1)),E===0?x.style.top=this.panelHeight*(this.vPanels-1)-p+"px":x.style.top=-this.panelHeight+"px"),m.style.top=M+"px",this.shading&&(this.shaders[h].top[E]=x.getElementsByClassName("oridomi-shader-top")[0],this.shaders[h].bottom[E]=x.getElementsByClassName("oridomi-shader-bottom")[0]),this.panels[h][E]=x,E!==0&&this.panels[h][E-1].appendChild(x);this.stages[h].appendChild(this.panels[h][0])}L=b.cloneNode(!0),L.className="oridomi-mask-v",this.shading&&(S=L.getElementsByClassName("oridomi-shader-top")[0],S.className="oridomi-shader-left",S.style.background=this._getShaderGradient("left"),T=L.getElementsByClassName("oridomi-shader-bottom")[0],T.className="oridomi-shader-right",T.style.background=this._getShaderGradient("right")),A=w.cloneNode(!1),A.className="oridomi-panel-v",A.style.width=this.panelWidth+p+"px",A.style.height="100%",A.style[n.origin]="left",A.appendChild(L),Y=["left","right"];for(U=0,I=Y.length;U<I;U++){h=Y[U];for(E=z=0,Z=this.vPanels;0<=Z?z<Z:z>Z;E=0<=Z?++z:--z)x=A.cloneNode(!0),m=x.getElementsByClassName("oridomi-content")[0],h==="left"?(O=-(E*this.panelWidth),E===0?x.style.left="0":x.style.left=this.panelWidth+"px"):(x.style[n.origin]="right",O=-(this.vPanels*this.panelWidth-this.panelWidth*(E+1)),E===0?x.style.left=this.panelWidth*(this.vPanels-1)-1+"px":x.style.left=-this.panelWidth+"px"),m.style.left=O+"px",this.shading&&(this.shaders[h].left[E]=x.getElementsByClassName("oridomi-shader-left")[0],this.shaders[h].right[E]=x.getElementsByClassName("oridomi-shader-right")[0]),this.panels[h][E]=x,E!==0&&this.panels[h][E-1].appendChild(x);this.stages[h].appendChild(this.panels[h][0])}this.el.classList.add(this.settings.oriDomiClass),this.originalStyles={},et=["padding","width","height","backgroundColor","backgroundImage","border","outline"];for(W=0,q=et.length;W<q;W++)u=et[W],this.originalStyles[u]=y[u];this.el.style.padding="0",this.el.style.width=this.width+"px",this.el.style.height=this.height+"px",this.el.style.backgroundColor="transparent",this.el.style.backgroundImage="none",this.el.style.border="none",this.el.style.outline="none",this.stages.left.style.display="block",this.stageEl=document.createElement("div"),this.stageEl.addEventListener("touchstart",this._onTouchStart,!1),this.stageEl.addEventListener("mousedown",this._onTouchStart,!1),this.stageEl.addEventListener("touchend",this._onTouchEnd,!1),this.stageEl.addEventListener("mouseup",this._onTouchEnd,!1),this.settings.touchEnabled&&this.enableTouch(),tt=this.anchors;for(X=0,R=tt.length;X<R;X++)h=tt[X],this.stageEl.appendChild(this.stages[h]);this.settings.showOnStart&&(this.el.style.display="block",this.el.style.visibility="visible"),this.el.innerHTML="",this.el.appendChild(this.cleanEl),this.el.appendChild(this.stageEl),nt=[0,0],this._xLast=nt[0],this._yLast=nt[1],this.lastOp={method:"accordion",options:{}},e&&(this.$el=e(this.el)),o.push(this),this._callback(this.settings),i&&console.timeEnd("oridomiConstruction")}return t.prototype._callback=function(e){var t,r=this;if(typeof e.callback=="function")return t=function(r){return r.currentTarget.removeEventListener(n.transitionEnd,t,!1),e.callback()},this.lastAngle===0?e.callback():this.panels[this.lastAnchor][0].addEventListener(n.transitionEnd,t,!1)},t.prototype._transform=function(e,t){var n,r;switch(this.lastAnchor){case"left":n=[0,1,0,e];break;case"right":n=[0,1,0,-e];break;case"top":n=[1,0,0,-e];break;case"bottom":n=[1,0,0,e]}return t&&(r=[1,1,1],n[0]=r[0],n[1]=r[1],n[2]=r[2]),"rotate3d("+n[0]+", "+n[1]+", "+n[2]+", "+n[3]+"deg)"},t.prototype._normalizeAngle=function(e){return e=parseFloat(e,10),isNaN(e)?0:e>89?89:e<-89?-89:e},t.prototype._normalizeArgs=function(e,t){var n,r,i,o=this;return this.isFrozen&&this.unfreeze(),r=this._normalizeAngle(t[0]),n=this._getLonghandAnchor(t[1]||this.lastAnchor),i=s(t[2],this._methodDefaults[e]),this.lastOp={method:e,options:i,negative:r<0},n!==this.lastAnchor||e==="foldUp"&&this.lastAngle!==0||this.isFoldedUp?(this.reset(function(){return o._showStage(n),o._touchEnabled&&o._setCursor(),setTimeout(function(){return e==="foldUp"&&t.shift(),o[e].apply(o,t)},0)}),!1):(this.lastAngle=r,[r,n,i])},t.prototype._setShader=function(e,t,n){var r,i,s,o;i=Math.abs(n),o=i/90*this.shadingIntensity,this.shading==="hard"?(o*=.15,this.lastAngle<0?n=i:n=-i):o*=.4;switch(t){case"left":case"top":n<0?(r=o,s=0):(r=0,s=o);break;case"right":case"bottom":n<0?(r=0,s=o):(r=o,s=0)}return t==="left"||t==="right"?(this.shaders[t].left[e].style.opacity=r,this.shaders[t].right[e].style.opacity=s):(this.shaders[t].top[e].style.opacity=r,this.shaders[t].bottom[e].style.opacity=s)},t.prototype._getShaderGradient=function(e){return""+n.gradientProp+"("+e+", rgba(0, 0, 0, .5) 0%, rgba(255, 255, 255, .35) 100%)"},t.prototype._showStage=function(e){return this.stages[e].style.display="block",this.stages[this.lastAnchor].style.display="none",this.lastAnchor=e},t.prototype._getPanelType=function(e){return e==="left"||e==="right"?this.vPanels:this.hPanels},t.prototype._getLonghandAnchor=function(e){switch(e){case"left":case"l":case"4":case 4:return"left";case"right":case"r":case"2":case 2:return"right";case"top":case"t":case"1":case 1:return"top";case"bottom":case"b":case"3":case 3:return"bottom";default:return"left"}},t.prototype._setTweening=function(e){var t,r,i,s,o,u;typeof e=="boolean"&&(e=e?this.settings.speed+"ms":"0ms"),this.lastAnchor==="left"||this.lastAnchor==="right"?i=["left","right"]:i=["top","bottom"],u=this.panels[this.lastAnchor];for(t=s=0,o=u.length;s<o;t=++s)r=u[t],r.style[n.transitionDuration]=e,this.shading&&(this.shaders[this.lastAnchor][i[0]][t].style[n.transitionDuration]=e,this.shaders[this.lastAnchor][i[1]][t].style[n.transitionDuration]=e);return null},t.prototype._setCursor=function(){return this._touchEnabled?this.lastAnchor==="left"||this.lastAnchor==="right"?this.stageEl.style.cursor="ew-resize":this.stageEl.style.cursor="ns-resize":this.stageEl.style.cursor="default"},t.prototype._methodDefaults={accordion:{sticky:!1,stairs:!1,fracture:!1,twist:!1},curl:{twist:!1},ramp:{},foldUp:{}},t.prototype._onTouchStart=function(e){if(!this._touchEnabled)return;return e.preventDefault(),this._setTweening(!1),this._touchAxis=this.lastAnchor==="left"||this.lastAnchor==="right"?"x":"y",this["_"+this._touchAxis+"Last"]=this.lastAngle,e.type==="mousedown"?this["_"+this._touchAxis+"1"]=e["page"+this._touchAxis.toUpperCase()]:this["_"+this._touchAxis+"1"]=e.targetTouches[0]["page"+this._touchAxis.toUpperCase()],this.stageEl.addEventListener("touchmove",this._onTouchMove,!1),this.stageEl.addEventListener("mousemove",this._onTouchMove,!1),this.settings.touchStartCallback(this["_"+this._touchAxis+"1"])},t.prototype._onTouchMove=function(e){var t,n,r;if(!this._touchEnabled)return;return e.preventDefault(),e.type==="mousemove"?t=e["page"+this._touchAxis.toUpperCase()]:t=e.targetTouches[0]["page"+this._touchAxis.toUpperCase()],r=(t-this["_"+this._touchAxis+"1"])*this.settings.touchSensitivity,this.lastOp.negative?(this.lastAnchor==="right"||this.lastAnchor==="bottom"?n=this["_"+this._touchAxis+"Last"]-r:n=this["_"+this._touchAxis+"Last"]+r,n>0&&(n=0)):(this.lastAnchor==="right"||this.lastAnchor==="bottom"?n=this["_"+this._touchAxis+"Last"]+r:n=this["_"+this._touchAxis+"Last"]-r,n<0&&(n=0)),this[this.lastOp.method](n,this.lastAnchor,this.lastOp.options),this.settings.touchMoveCallback(n)},t.prototype._onTouchEnd=function(e){if(!this._touchEnabled)return;return this._setTweening(!0),this.stageEl.removeEventListener("touchmove",this._onTouchMove,!1),this.stageEl.removeEventListener("mousemove",this._onTouchMove,!1),this.settings.touchEndCallback(this["_"+this._touchAxis+"Last"])},t.prototype.reset=function(e){var t,r,i,s,o;if(this.isFoldedUp)return this.unfold(e);o=this.panels[this.lastAnchor];for(t=i=0,s=o.length;i<s;t=++i)r=o[t],r.style[n.transform]=this._transform(0),this.shading&&this._setShader(t,this.lastAnchor,0);return this._callback({callback:e})},t.prototype.freeze=function(e){var t=this;return this.isFrozen?typeof e=="function"?e():void 0:this.reset(function(){return t.isFrozen=!0,t.stageEl.style[n.transform]="translate3d(-9999px, 0, 0)",t.cleanEl.style[n.transform]="translate3d(0, 0, 0)",typeof e=="function"?e():void 0})},t.prototype.unfreeze=function(){if(this.isFrozen)return this.isFrozen=!1,this.cleanEl.style[n.transform]="translate3d(-9999px, 0, 0)",this.stageEl.style[n.transform]="translate3d(0, 0, 0)",this.lastAngle=0},t.prototype.destroy=function(t){var n=this;return this.freeze(function(){var r;e&&e.data(n.el,"oriDomi",null),n.el.innerHTML=n.cleanEl.innerHTML,r=n.originalStyles;for(u in r)d=r[u],n.el.style[u]=d;return o[o.indexOf(n)]=null,typeof t=="function"?t():void 0})},t.prototype.enableTouch=function(){return this._touchEnabled=!0,this._setCursor()},t.prototype.disableTouch=function(){return this._touchEnabled=!1,this._setCursor()},t.prototype.getInstance=function(){return this},t.prototype.accordion=function(e,t,r){var i,s,o,u,a,f,l;o=this._normalizeArgs("accordion",arguments);if(!o)return;e=o[0],t=o[1],r=o[2],l=this.panels[t];for(s=a=0,f=l.length;a<f;s=++a){u=l[s],s%2!==0&&!r.twist?i=-e:i=e;if(r.sticky){if(s===0)i=0;else if(s>1||r.stairs)i*=2}else s!==0&&(i*=2);r.stairs&&(i=-i),u.style[n.transform]=this._transform(i,r.fracture),this.shading&&(s!==0||!r.sticky)&&Math.abs(i)!==180&&this._setShader(s,t,i)}return this._callback(r)},t.prototype.curl=function(e,t,r){var i,s,o,u,a,f;s=this._normalizeArgs("curl",arguments);if(!s)return;e=s[0],t=s[1],r=s[2],e/=this._getPanelType(t),f=this.panels[t];for(i=u=0,a=f.length;u<a;i=++u)o=f[i],o.style[n.transform]=this._transform(e),this.shading&&this._setShader(i,t,0);return this._callback(r)},t.prototype.ramp=function(e,t,r){var i,s,o,u,a,f;s=this._normalizeArgs("ramp",arguments);if(!s)return;e=s[0],t=s[1],r=s[2],this.panels[t][1].style[n.transform]=this._transform(e),f=this.panels[t];for(i=u=0,a=f.length;u<a;i=++u)o=f[i],i>1&&(this.panels[t][i].style[n.transform]=this._transform(0)),this.shading&&this._setShader(i,t,0);return this._callback(r)},t.prototype.foldUp=function(e,t){var r,i,s,o,u,a=this;e?typeof e=="function"&&(t=e):e="left",o=this._normalizeArgs("foldUp",[0,e,{}]);if(!o)return;return e=o[1],this.isFoldedUp=!0,i=this.panels[e].length-1,r=100,s=function(){a.panels[e][i].addEventListener(n.transitionEnd,u,!1),a.panels[e][i].style[n.transform]=a._transform(r);if(a.shading)return a._setShader(i,e,r)},u=function(r){return a.panels[e][i].removeEventListener(n.transitionEnd,u,!1),a.panels[e][i].style.display="none",--i===0?typeof t=="function"?t():void 0:setTimeout(s,0)},s()},t.prototype.unfold=function(e){var t,r,i,s,o=this;return this.isFoldedUp||typeof e=="function"&&e(),this.isFoldedUp=!1,r=1,t=0,i=function(){return o.panels[o.lastAnchor][r].style.display="block",setTimeout(function(){o.panels[o.lastAnchor][r].addEventListener(n.transitionEnd,s,!1),o.panels[o.lastAnchor][r].style[n.transform]=o._transform(t);if(o.shading)return o._setShader(r,o.lastAnchor,t)},0)},s=function(t){return o.panels[o.lastAnchor][r].removeEventListener(n.transitionEnd,s,!1),++r===o.panels[o.lastAnchor].length?typeof e=="function"?e():void 0:setTimeout(i,0)},i()},t.prototype.collapse=function(e,t){return t==null&&(t={}),t.sticky=!1,this.accordion(-89,e,t)},t.prototype.collapseAlt=function(e,t){return t==null&&(t={}),t.sticky=!1,this.accordion(89,e,t)},t.prototype.reveal=function(e,t,n){return n==null&&(n={}),n.sticky=!0,this.accordion(e,t,n)},t.prototype.stairs=function(e,t,n){return n==null&&(n={}),n.stairs=!0,n.sticky=!0,this.accordion(e,t,n)},t.prototype.fracture=function(e,t,n){return n==null&&(n={}),n.fracture=!0,this.accordion(e,t,n)},t.prototype.twist=function(e,t,n){return n==null&&(n={}),n.fracture=!0,n.twist=!0,this.accordion(e/10,t,n)},t.VERSION="0.2.0",t.devMode=function(){return i=!0},t}(),c.OriDomi=t,e&&(e.fn.oriDomi=function(n){var r,s,o,u,a,l,c;if(!f)return this;if(typeof n=="string"){if(typeof t.prototype[n]!="function"){i&&console.warn("oriDomi: No such method '"+n+"'");return}for(u=0,l=this.length;u<l;u++){s=this[u],o=e.data(s,"oriDomi");if(o==null){i&&console.warn("oriDomi: Can't call "+n+", oriDomi hasn't been initialized on this element");return}r=Array.prototype.slice.call(arguments),r.shift();if(n==="getInstance")return o.getInstance();o[n].apply(o,r)}return this}for(a=0,c=this.length;a<c;a++){s=this[a],o=e.data(s,"oriDomi");if(o)return o;e.data(s,"oriDomi",new t(s,n))}return this})}).call(this);